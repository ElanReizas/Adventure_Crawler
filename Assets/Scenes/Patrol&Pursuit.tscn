[gd_scene load_steps=6 format=4 uid="uid://patroltest123"]

[ext_resource type="TileSet" uid="uid://bmuk58cqek4vi" path="res://Assets/map.tres" id="1_tileset"]
[ext_resource type="PackedScene" uid="uid://w7fn2ns1k5r" path="res://Assets/Scenes/Enemy.tscn" id="2_enemy"]
[ext_resource type="PackedScene" uid="uid://bf21l51gif70h" path="res://Assets/Scenes/Player.tscn" id="3_player"]

[sub_resource type="RectangleShape2D" id="Rect_PatrolZone"]
size = Vector2(400, 300)

[sub_resource type="NavigationPolygon" id="NavPolySimple"]
vertices = PackedVector2Array(0,0, 800,0, 800,600, 0,600)
polygons = Array[PackedInt32Array]([PackedInt32Array(0,1,2,3)])

[node name="PatrolTest" type="Node2D"]

# ------------- BACKGROUND TILEMAP -------------
[node name="TileMap" type="TileMapLayer" parent="."]
tile_set = ExtResource("1_tileset")
# Fill the tilemap with a simple rectangle
tile_map_data = PackedByteArray()

# ------------- SIMPLE NAVIGATION REGION -------------
[node name="NavigationRegion2D" type="NavigationRegion2D" parent="."]
navigation_polygon = SubResource("NavPolySimple")

# ------------- PATROL ZONE -------------
[node name="PatrolZone" type="Area2D" parent="."]
position = Vector2(400, 300)

[node name="CollisionShape2D" type="CollisionShape2D" parent="PatrolZone"]
shape = SubResource("Rect_PatrolZone")

# ------------- PLAYER -------------
[node name="Player" parent="." instance=ExtResource("3_player")]
position = Vector2(200, 300)
weapon_type = 1

# ------------- ENEMY -------------
[node name="Enemy" parent="." node_paths=PackedStringArray("patrol_zone") instance=ExtResource("2_enemy")]
position = Vector2(600, 300)
patrol_zone = NodePath("../PatrolZone")
detection_radius = 250.0
max_pursuit_time = 5.0
